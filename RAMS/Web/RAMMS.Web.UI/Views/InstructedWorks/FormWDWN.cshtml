@model RAMMS.Web.UI.Models.FormWDWNModel;
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewBag.TabTitle = "Form W2 -  Initiation of Instructed Work";
    ViewData["Title"] = "Form W2 - Initiation of Instructed Work";
    Layout = null;// "~/Views/Shared/_PortalLayout.cshtml";

    var ActiveWD = Model.FormName == "FormWD" ? "active" : "";
    var ActiveWN = Model.FormName == "FormWN" ? "active" : "";
    var ShowWD = Model.FormName == "FormWD" ? "show" : "";
    var ShowWN = Model.FormName == "FormWN" ? "show" : "";
}
<script src="~/js/FormWDWN.js" type="text/javascript"></script>
<style>
    .disabled {
        pointer-events: none;
        opacity: 0.6;
    }
</style>

@using (Html.BeginForm())
{
    <div class="row bg-white row bg-white pt-3 pb-0" style="border-top:1px solid #dee2e6;" id="FormWDWNpage">
        <div class="col-md-12">
            <div class="w-100 position-relative pt-2 float-left d-flex justify-content-center">
                <ul class="nav nav-tabs tabbed round">

                    <li class="nav-item" id="tabWD">
                        <a href="#list_one" data-toggle="tab" aria-expanded="false" class="nav-link @ActiveWD">
                            <span class="">
                                Form WD
                            </span>
                        </a>
                    </li>
                    <li class="nav-item" id="tabWN">
                        <a href="#list_two" data-toggle="tab" aria-expanded="false" class="nav-link @ActiveWN">
                            <span class="">
                                Form WN
                            </span>
                        </a>
                    </li>
                    <li class="nav-item" id="tabAttach">
                        <a href="#AccordPagegallery" data-toggle="tab" aria-expanded="false" class="nav-link" onclick="javascript:GetImageList('@Model.FormW1.PkRefNo','FormWDWN');">
                            <span class="">
                                Attachment
                            </span>
                        </a>
                    </li>

                </ul>
                <div class="d-flex py-2 position-absolute" style="right: 0px;width: 40%; top:0px;">
                    <div class="form-group mb-0 px-2" style="margin-top: -9px;">
                        IW Ref No: <input type="text" placeholder="" disabled class="form-control" value="@Model.FormW1.IwRefNo">
                    </div>
                    <div class="form-group mb-0" style="margin-top: -9px;">
                        Project Title<input type="text" class="form-control" disabled value="@Model.FormW1.ProjectTitle">
                    </div>
                </div>
            </div>

            <div class="row bg-white py-3">
                <div class="col-lg-12">
                    <div class="tab-content mh-250">

                        <div class="tab-pane  @ShowWD @ActiveWD" id="list_one">
                            <div id="div_wdload">
                                @{
                                    Html.RenderPartial("_FormWD.cshtml", Model);
                                }
                            </div>
                        </div>

                        <div class="tab-pane @ShowWN @ActiveWN" id="list_two">
                            <div id="div_wnload">
                                @{
                                    Html.RenderPartial("_FormWN.cshtml", Model);
                                }
                            </div>
                        </div>
                        <div class="tab-pane" id="AccordPagegallery">
                            <div id="ViewPhoto">

                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @Html.HiddenFor(m => m.ClauseDetails);
    @Html.HiddenFor(m => m.FormWD.IwRefNo);
    @Html.HiddenFor(m => m.FormWN.IwRefNo);
    @Html.HiddenFor(m => m.FormWD.IwProjectTitle);
    @Html.HiddenFor(m => m.FormWN.IwProjectTitle);
    @Html.HiddenFor(m => m.FormWD.PkRefNo);
    @Html.HiddenFor(m => m.FormWN.PkRefNo);
    @Html.HiddenFor(m => m.FormWD.Fw1PkRefNo);
    @Html.HiddenFor(m => m.FormWN.Fw1PkRefNo);
    @Html.HiddenFor(m => m.FormWD.Status);
    @Html.HiddenFor(m => m.FormWD.SubmitSts);
    @Html.HiddenFor(m => m.FormWN.Status);
    @Html.HiddenFor(m => m.FormWN.SubmitSts);
    @Html.HiddenFor(m => m.FormWD.UseridIssu);
    @Html.HiddenFor(m => m.FormWN.UseridIssu);

    <input type="hidden" id="hdnWDPkRefNo" />
    <input type="hidden" id="hdnWNPkRefNo" />
    <input type="hidden" id="hdnView" value="@Model.View" />
    <input type="hidden" id="hdnFormWDStatus" value="@Model.FormWD.Status" />
    <input type="hidden" id="hdnFormWNStatus" value="@Model.FormWN.Status" />
    <input type="hidden" id="hdnDtPervCompl">

}
<script>

    $(document).ready(function () {

        process.Init("FormWD", "@Model.FormWD.Status", @Model.FormWD.PkRefNo);
        process.Init("FormWN", "@Model.FormWN.Status", @Model.FormWN.PkRefNo);

        $('#FormWD_IwRefNo').val("@Model.FormW1.IwRefNo")
        $('#FormWD_Fw1PkRefNo').val("@Model.FormW1.PkRefNo")
        $('#FormWN_IwRefNo').val("@Model.FormW1.IwRefNo")
        $('#FormWN_Fw1PkRefNo').val("@Model.FormW1.PkRefNo")
        $('#FormWD_IwProjectTitle').val("@Model.FormW1.ProjectTitle")
        $('#FormWN_IwProjectTitle').val("@Model.FormW1.ProjectTitle")

        $('#ddlWDUserid').val("@Model.FormWD.UseridIssu");
        $('#ddlWDUserid').trigger('chosen:updated');
        $("#ddlWDUserid").trigger("change");

        $('#ddlWNUserid').val("@Model.FormWN.UseridIssu");
        $('#ddlWNUserid').trigger('chosen:updated');
        $("#ddlWNUserid").trigger("change");

        $("#ddlWDUserid").chosen('destroy');
        $("#ddlWDUserid").prop("disabled", true);
        $("#ddlWNUserid").chosen('destroy');
        $("#ddlWNUserid").prop("disabled", true);

        if ($("#hdnFormWDStatus").val() == "Saved") {
            $("#tabWN").addClass("disabled");
        }
        else if ($("#hdnFormWDStatus").val() == "Submitted") {
            $("#FormWDpage *").prop("disabled", true);

            $("#FormWD_IwWrksDeptId").chosen('destroy');
            $("#FormWD_IwWrksDeptId").prop("disabled", true);

            $("#btnSaveWD").hide();
            $("#btnSubmitWD").hide();
        }

        if ($("#hdnFormWNStatus").val() == "Saved" && $("#hdnFormWDStatus").val() == "") {
            $("#tabWD").addClass("disabled");
        }
        else if ($("#hdnFormWNStatus").val() == "Submitted") {
            if ($("#hdnFormWDStatus").val() == "")
                $("#tabWD").addClass("disabled");

           $("#FormWNpage *").prop("disabled", true);

            $("#FormWN_IwWrksDeptId").chosen('destroy');
            $("#FormWN_IwWrksDeptId").prop("disabled", true);

            $("#btnSaveWN").hide();
            $("#btnSubmitWN").hide();
        }


    });

    $("#hdnDtPervCompl").val("@Model.FormWD.DtPervCompl");

</script>

