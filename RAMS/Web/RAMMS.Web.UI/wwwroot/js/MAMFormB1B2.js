var _hd = {
    hdnPkRefNo: $("#hdnPkRefNo"),
    hdnDPkRefNo: $("#hdnDPkRefNo"),
    hdnIsView: $("#hdnIsView"),
    txtReferenceNo: $("#txtReferenceNo"),
    hdnYear: $("#hdnYear"),
    ddlBridgeId: $("#ddlBridgeId"),
    ddlDivision: $("#ddlDivision"),
    ddlSectionCode: $("#ddlSectionCode"),
    txtSectionName: $("#txtSectionName"),
    ddlRdCode: $("#ddlRdCode"),
    ddlRmuCode: $("#ddlRmuCode"),
    txtBridgeId: $("#txtBridgeId"),
    txtDateofInspection: $("#txtDateofInspection"),
    ddlYear: $("#ddlYear"),
    ddlRatingRecordno: $("#ddlRatingRecordno"),
    txtDivision: $("#txtDivision"),
    txtRmu: $("#txtRmu"),
    txtRoadcode: $("#txtRoadcode"),
    txtRoadName: $("#txtRoadName"),
    txtRoadname: $("#txtRoadname"),
    txtStructcode: $("#txtStructcode"),
    txtLocationchKm: $("#txtLocationchKm"),
    txtLocationchM: $("#txtLocationchM"),
    txtRiverName: $("#txtRiverName"),
    txtLandwidth: $("#txtLandwidth"),
    txtSpanlength: $("#txtSpanlength"),
    txtBridgelength: $("#txtBridgelength"),
    txtBridgewidth: $("#txtBridgewidth"),
    txtNooflane: $("#txtNooflane"),
    txtNoofspan: $("#txtNoofspan"),
    txtMedian: $("#txtMedian"),
    txtWalkway: $("#txtWalkway"),
    txtSuperstructure: $("#txtSuperstructure"),
    txtParapettype: $("#txtParapettype"),
    txtBearingtype: $("#txtBearingtype"),
    txtExpansiontype: $("#txtExpansiontype"),
    txtDecktype: $("#txtDecktype"),
    txtAbutmenttype: $("#txtAbutmenttype"),
    txtPiertype: $("#txtPiertype"),
    txtNoofexpansion: $("#txtNoofexpansion"),
    txtGpseasting: $("#txtGpseasting"),
    txtGpsNorthing: $("#txtGpsNorthing"),

    txtAbutFoundMat: $("#txtAbutFoundMat"),
    txtAbutFoundMatCode: $("#txtAbutFoundMatCode"),
    ddlAbutFoundMatDistress: $("#ddlAbutFoundMatDistress"),
    txtAbutFoundMatOthers: $("#txtAbutFoundMatOthers"),
    ddlAbutFoundMatSeverity: $("#ddlAbutFoundMatSeverity"),

    txtBeamsGridTrusArch: $("#txtBeamsGridTrusArch"),
    txtBeamsGridTrusArchCode: $("#txtBeamsGridTrusArchCode"),
    ddlBeamsGridTrusArchDistress: $("#ddlBeamsGridTrusArchDistress"),
    txtBeamsGridOthers: $("#txtBeamsGridOthers"),
    ddlBeamsGridTrusArchSeverity: $("#ddlBeamsGridTrusArchSeverity"),

    txtBearingStDiaphgMat: $("#txtBearingStDiaphgMat"),
    txtBearingStDiaphgMatCode: $("#txtBearingStDiaphgMatCode"),
    ddlBearingStDiaphgMatDistress: $("#ddlBearingStDiaphgMatDistress"),
    ddlBearingStDiaphgMatSeverity: $("#ddlBearingStDiaphgMatSeverity"),
    txtBearingStDiaphgOthers: $("#txtBearingStDiaphgOthers"),

    txtDeckPavement: $("#txtDeckPavement"),
    txtDeckPavementCode: $("#txtDeckPavementCode"),
    ddlDeckPavementDistress: $("#ddlDeckPavementDistress"),
    ddlDeckPavementSeverity: $("#ddlDeckPavementSeverity"),
    txtDeckPavementOthers: $("#txtDeckPavementOthers"),

    txtExpanJoint: $("#txtExpanJoint"),
    txtExpanJointCode: $("#txtExpanJointCode"),
    ddlExpanJointDistress: $("#ddlExpanJointDistress"),
    ddlExpanJointSeverity: $("#ddlExpanJointSeverity"),
    txtExpanJointOthers: $("#txtExpanJointOthers"),

    txtParapetRailing: $("#txtParapetRailing"),
    txtParapetRailingCode: $("#txtParapetRailingCode"),
    ddlParapetRailingDistress: $("#ddlParapetRailingDistress"),
    ddlParapetRailingSeverity: $("#ddlParapetRailingSeverity"),
    txtParapetRailingOthers: $("#txtParapetRailingOthers"),

    txtPiersPrimCompMat: $("#txtPiersPrimCompMat"),
    txtPiersPrimCompMatCode: $("#txtPiersPrimCompMatCode"),
    ddlPiersPrimCompMatDistress: $("#ddlPiersPrimCompMatDistress"),
    ddlPiersPrimCompMatSeverity: $("#ddlPiersPrimCompMatSeverity"),
    txtPiersPrimCompOthers: $("#txtPiersPrimCompOthers"),

    txtSidewalksAppSlab: $("#txtSidewalksAppSlab"),
    txtSidewalksAppSlabCode: $("#txtSidewalksAppSlabCode"),
    ddlSidewalksAppSlabDistress: $("#ddlSidewalksAppSlabDistress"),
    ddlSidewalksAppSlabSeverity: $("#ddlSidewalksAppSlabSeverity"),
    txtSidewalksOthers: $("#txtSidewalksOthers"),

    txtSlopeRetainWall: $("#txtSlopeRetainWall"),
    txtSlopeRetainWallCode: $("#txtSlopeRetainWallCode"),
    ddlSlopeRetainWallDistress: $("#ddlSlopeRetainWallDistress"),
    ddlSlopeRetainWallSeverity: $("#ddlSlopeRetainWallSeverity"),
    txtSlopeRetainWallOthers: $("#txtSlopeRetainWallOthers"),

    txtUtilities: $("#txtUtilities"),
    txtUtilitiesCode: $("#txtUtilitiesCode"),
    ddlUtilitiesDistress: $("#ddlUtilitiesDistress"),
    ddlUtilitiesSeverity: $("#ddlUtilitiesSeverity"),
    txtUtilitiesOthers: $("#txtUtilitiesOthers"),

    txtWaterDownpipe: $("#txtWaterDownpipe"),
    txtWaterDownpipeCode: $("#txtWaterDownpipeCode"),
    ddlWaterDownpipeDistress: $("#ddlWaterDownpipeDistress"),
    ddlWaterDownpipeSeverity: $("#ddlWaterDownpipeSeverity"),
    txtWaterDownpipeOthers: $("#txtWaterDownpipeOthers"),

    txtWaterway: $("#txtWaterway"),
    txtWaterwayCode: $("#txtWaterwayCode"),
    ddlWaterwayDistress: $("#ddlWaterwayDistress"),
    ddlWaterwaySeverity: $("#ddlWaterwaySeverity"),
    txtWaterwayOthers: $("#txtWaterwayOthers"),

    ddlInspectedby: $("#ddlInspectedby"),
    txtServiceProvidername: $("#txtServiceProvidername"),
    txtServiceProviderDesignation: $("#txtServiceProviderDesignation"),
    txtServiceProviderDate: $("#txtServiceProviderDate"),
    ddlBrideConditionRating: $("#ddlBrideConditionRating"),
    ddlHasIssueFound: $("#ddlHasIssueFound"),
    ddlAuditedby: $("#ddlAuditedby"),
    txtAuditedbyName: $("#txtAuditedbyName"),
    txtAuditedbyDesignation: $("#txtAuditedbyDesignation"),
    txtAuditedByDate: $("#txtAuditedByDate"),
    txtBServiceprovider: $("#txtBServiceprovider"),
    txtBEngineeringconsultant: $("#txtBEngineeringconsultant"),
    txtCServiceprovider: $("#txtCServiceprovider"),
    txtCEngineeringconsultant: $("#txtCEngineeringconsultant"),
    txtDServiceprovider: $("#txtDServiceprovider"),
    txtDEngineeringconsultant: $("#txtDEngineeringconsultant"),
    btnHCancel: $("#btnHCancel"),
    btnHSave: $("#btnHSave"),
    btnHSubmit: $("#btnHSubmit"),
    btnFindDetail: $("#btnFindDetail"),
    btnImgTab: $("#btnImgTab"),
    hdnAbutFoundDistress: $("#hdnAbutFoundDistress"),
    hdnBeamsGridTrusArchDistress: $("#hdnBeamsGridTrusArchDistress"),
    hdnBearingStDiaphgDistress: $("#hdnBearingStDiaphgDistress"),
    hdnDeckPavementDistress: $("#hdnDeckPavementDistress"),
    hdnExpanJointDistress: $("#hdnExpanJointDistress"),
    hdnParapetRailingDistress: $("#hdnParapetRailingDistress"),
    hdnPiersPrimCompDistress: $("#hdnPiersPrimCompDistress"),
    hdnSidewalksAppSlabDistress: $("#hdnSidewalksAppSlabDistress"),
    hdnSlopeRetainWallDistress: $("#hdnSlopeRetainWallDistress"),
    hdnUtilitiesDistress: $("#hdnUtilitiesDistress"),
    hdnWaterDownpipeDistress: $("#hdnWaterDownpipeDistress"),
    hdnWaterwayDistress: $("#hdnWaterwayDistress")
};

function assign(s) {
    _hd.txtRoadcode.val(s.aiRdCode);
    _hd.txtRoadname.val(s.aiRdName);
    _hd.txtDivision.val(s.aiDivCode);
    _hd.txtRmu.val(s.aiRmuName);
    _hd.txtStructcode.val(s.aiStrucCode);
    _hd.txtLocationchKm.val(s.aiLocChKm);
    _hd.txtLocationchM.val(s.aiLocChM);
    _hd.txtRiverName.val(s.aiRiverName);
    _hd.txtLandwidth.val(s.aiWidthLane);
    _hd.txtSpanlength.val(s.aiLengthSpan);
    _hd.txtBridgelength.val(s.aiLength);
    _hd.txtBridgewidth.val(s.aiWidth);
    _hd.txtNooflane.val(s.aiLaneCnt);
    _hd.txtNoofspan.val(s.aiSpanCnt);
    _hd.txtMedian.val(s.aiMedian);
    _hd.txtWalkway.val(s.aiWalkway);
    _hd.txtSuperstructure.val(s.aiStrucSuper);
    _hd.txtParapettype.val(s.aiParapetType);
    _hd.txtBearingtype.val(s.aiBearingType);
    _hd.txtExpansiontype.val(s.aiExpanType);
    _hd.txtDecktype.val(s.aiDeckType);
    _hd.txtAbutmenttype.val(s.aiAbutType);
    _hd.txtPiertype.val(s.aiPierType);
    _hd.txtNoofexpansion.val(s.aiExpanJointCount);
    _hd.txtGpseasting.val(s.aiGpsEasting);
    _hd.txtGpsNorthing.val(s.aiGpsNorthing);
    _hd.txtBridgeId.val(s.aiAssetId);

    _hd.txtAbutFoundMat.val(s.detail.abutFoundMat);
    _hd.txtAbutFoundMatCode.val(s.detail.abutFoundMatCode);
    _hd.txtAbutFoundMatOthers.val(s.detail.AbutFoundDistressOthers);

    _hd.txtBeamsGridTrusArch.val(s.detail.beamsGridTrusArch);
    _hd.txtBeamsGridTrusArchCode.val(s.detail.beamsGridTrusArchCode);
    _hd.txtBeamsGridOthers.val(s.detail.BeamsGridTrusArchDistressOthers);

    _hd.txtBearingStDiaphgMat.val(s.detail.bearingStDiaphgMat);
    _hd.txtBearingStDiaphgMatCode.val(s.detail.bearingStDiaphgMatCode);
    _hd.txtBearingStDiaphgOthers.val(s.detail.bearingStDiaphgMatCode);

    _hd.txtDeckPavement.val(s.detail.deckPavement);
    _hd.txtDeckPavementCode.val(s.detail.deckPavementCode);
    _hd.txtDeckPavementOthers.val(s.detail.DeckPavementDistressOthers);

    _hd.txtExpanJoint.val(s.detail.expanJoint);
    _hd.txtExpanJointCode.val(s.detail.expanJointCode);
    _hd.txtExpanJointOthers.val(s.detail.ExpanJointDistressOthers);

    _hd.txtParapetRailing.val(s.detail.parapetRailing);
    _hd.txtParapetRailingCode.val(s.detail.parapetRailingCode);
    _hd.txtParapetRailingOthers.val(s.detail.ParapetRailingDistressOthers);

    _hd.txtPiersPrimCompMat.val(s.detail.piersPrimCompMat);
    _hd.txtPiersPrimCompMatCode.val(s.detail.piersPrimCompMatCode);
    _hd.txtPiersPrimCompOthers.val(s.detail.PiersPrimCompDistressOthers);

    _hd.txtSidewalksAppSlab.val(s.detail.sidewalksAppSlab);
    _hd.txtSidewalksAppSlabCode.val(s.detail.sidewalksAppSlabCode);
    _hd.txtSidewalksOthers.val(s.detail.SidewalksAppSlabDistressOthers);

    _hd.txtSlopeRetainWall.val(s.detail.slopeRetainWall);
    _hd.txtSlopeRetainWallCode.val(s.detail.slopeRetainWallCode);
    _hd.txtSlopeRetainWallOthers.val(s.detail.SlopeRetainWallDistressOthers);

    _hd.txtUtilities.val(s.detail.utilities);
    _hd.txtUtilitiesCode.val(s.detail.utilitiesCode);
    _hd.txtUtilitiesOthers.val(s.detail.UtilitiesDistressOthers);

    _hd.txtWaterDownpipe.val(s.detail.waterDownpipe);
    _hd.txtWaterDownpipeCode.val(s.detail.waterDownpipeCode);
    _hd.txtWaterDownpipeOthers.val(s.detail.WaterDownpipeDistressOthers);

    _hd.txtWaterway.val(s.detail.waterway);
    _hd.txtWaterwayCode.val(s.detail.waterwayCode);
    _hd.txtWaterwayOthers.val(s.detail.WaterwayDistressOthers);
}

function concatenate(e) {
    try {
        var array = e.val();
        var value = '';
        if (array.length > 0) {
            $.each(array, function (i, v) {
                if (value != '') {
                    value += ",";
                }
                value += v;

            });
        }
        return value;
    }
    catch{
        return "";
    }

}

function get() {
    return {
        PkRefNo: _hd.hdnPkRefNo.val(),
        YearOfInsp: _hd.ddlYear.val(),
        CInspRefNo: _hd.txtReferenceNo.val(),
        AiPkRefNo: _hd.ddlBridgeId.val(),
        DisplayAssetId: _hd.ddlBridgeId.text(),
        RecordNo: _hd.ddlRatingRecordno.val(),
        DtOfInsp: _hd.txtDateofInspection.val(),
        AiAssetId: _hd.txtBridgeId.val(),
        AiRdCode: _hd.txtRoadcode.val(),
        AiRdName: _hd.txtRoadname.val(),
        AiDivCode: _hd.txtDivision.val(),
        AiRmuName: _hd.txtRmu.val(),
        AiStrucCode: _hd.txtStructcode.val(),
        AiLocChKm: _hd.txtLocationchKm.val(),
        AiLocChM: _hd.txtLocationchM.val(),
        AiRiverName: _hd.txtRiverName.val(),
        AiWidthLane: _hd.txtLandwidth.val(),
        AiLengthSpan: _hd.txtSpanlength.val(),
        AiLength: _hd.txtBridgelength.val(),
        AiWidth: _hd.txtBridgewidth.val(),
        AiLaneCnt: _hd.txtNooflane.val(),
        AiSpanCnt: _hd.txtNoofspan.val(),
        AiMedian: _hd.txtMedian.val(),
        AiWalkway: _hd.txtWalkway.val(),
        AiStrucSuper: _hd.txtSuperstructure.val(),
        AiParapetType: _hd.txtParapettype.val(),
        AiBearingType: _hd.txtBearingtype.val(),
        AiExpanType: _hd.txtExpansiontype.val(),
        AiDeckType: _hd.txtDecktype.val(),
        AiAbutType: _hd.txtAbutmenttype.val(),
        AiPierType: _hd.txtPiertype.val(),
        AiExpanJointCount: _hd.txtNoofexpansion.val(),
        AiGpsEasting: _hd.txtGpseasting.val(),
        AiGpsNorthing: _hd.txtGpsNorthing.val(),
        SerProviderDefObs: _hd.txtBServiceprovider.val(),
        SerProviderDefGenCom: _hd.txtCServiceprovider.val(),
        SerProviderDefFeedback: _hd.txtDServiceprovider.val(),
        SerProviderUserId: _hd.ddlInspectedby.val(),
        SerProviderUserName: _hd.txtServiceProvidername.val(),
        SerProviderUserDesignation: _hd.txtServiceProviderDesignation.val(),
        SerProviderInsDt: _hd.txtServiceProviderDate.val(),
        AuthDefObs: _hd.txtBEngineeringconsultant.val(),
        AuthDefGenCom: _hd.txtCEngineeringconsultant.val(),
        AuthDefFeedback: _hd.txtDEngineeringconsultant.val(),
        BridgeConditionRat: _hd.ddlBrideConditionRating.val(),
        ReqFurtherInv: _hd.ddlHasIssueFound.val(),
        UserIdAud: _hd.ddlAuditedby.val(),
        UserNameAud: _hd.txtAuditedbyName.val(),
        UserDesignationAud: _hd.txtAuditedbyDesignation.val(),
        DtAud: _hd.txtAuditedByDate.val(),
        Detail: {
            PkRefNo: _hd.hdnDPkRefNo.val(),
            FbrihPkRefNo: _hd.hdnPkRefNo.val(),
            AbutFoundMat: _hd.txtAbutFoundMat.val(),
            AbutFoundMatCode: _hd.txtAbutFoundMatCode.val(),
            AbutFoundDistress: concatenate(_hd.ddlAbutFoundMatDistress),
            AbutFoundDistressOthers: _hd.txtAbutFoundMatOthers.val(),
            AbutFoundSeverity: _hd.ddlAbutFoundMatSeverity.val(),

            BeamsGridTrusArch: _hd.txtBeamsGridTrusArch.val(),
            BeamsGridTrusArchCode: _hd.txtBeamsGridTrusArchCode.val(),
            BeamsGridTrusArchDistress: concatenate(_hd.ddlBeamsGridTrusArchDistress),
            BeamsGridTrusArchSeverity: _hd.ddlBeamsGridTrusArchSeverity.val(),
            BeamsGridTrusArchDistressOthers: _hd.txtBeamsGridOthers.val(),

            BearingStDiaphgMat: _hd.txtBearingStDiaphgMat.val(),
            BearingStDiaphgMatCode: _hd.txtBearingStDiaphgMatCode.val(),
            BearingStDiaphgDistress: concatenate(_hd.ddlBearingStDiaphgMatDistress),
            BearingStDiaphgSeverity: _hd.ddlBearingStDiaphgMatSeverity.val(),
            BearingStDiaphgDistressOthers: _hd.txtBearingStDiaphgOthers.val(),

            DeckPavement: _hd.txtDeckPavement.val(),
            DeckPavementCode: _hd.txtDeckPavementCode.val(),
            DeckPavementDistress: concatenate(_hd.ddlDeckPavementDistress),
            DeckPavementSeverity: _hd.ddlDeckPavementSeverity.val(),
            DeckPavementDistressOthers: _hd.txtDeckPavementOthers.val(),

            ExpanJointSeverity: _hd.ddlExpanJointSeverity.val(),
            ExpanJointDistress: concatenate(_hd.ddlExpanJointDistress),
            ExpanJoint: _hd.txtExpanJoint.val(),
            ExpanJointCode: _hd.txtExpanJointCode.val(),
            ExpanJointDistressOthers: _hd.txtExpanJointOthers.val(),

            ParapetRailing: _hd.txtParapetRailing.val(),
            ParapetRailingCode: _hd.txtParapetRailingCode.val(),
            ParapetRailingDistress: concatenate(_hd.ddlParapetRailingDistress),
            ParapetRailingSeverity: _hd.ddlParapetRailingSeverity.val(),
            ParapetRailingDistressOthers: _hd.txtParapetRailingOthers.val(),

            PiersPrimCompDistress: concatenate(_hd.ddlPiersPrimCompMatDistress),
            PiersPrimCompSeverity: _hd.ddlParapetRailingSeverity.val(),
            PiersPrimCompMat: _hd.txtPiersPrimCompMat.val(),
            PiersPrimCompMatCode: _hd.txtPiersPrimCompMatCode.val(),
            PiersPrimCompDistressOthers: _hd.txtPiersPrimCompOthers.val(),

            SidewalksAppSlab: _hd.txtSidewalksAppSlab.val(),
            SidewalksAppSlabCode: _hd.txtSidewalksAppSlabCode.val(),
            SidewalksAppSlabDistress: concatenate(_hd.ddlSidewalksAppSlabDistress),
            SidewalksAppSlabSeverity: _hd.ddlSidewalksAppSlabSeverity.val(),
            SidewalksAppSlabDistressOthers: _hd.txtSidewalksOthers.val(),

            SlopeRetainWall: _hd.txtSlopeRetainWall.val(),
            SlopeRetainWallCode: _hd.txtSlopeRetainWallCode.val(),
            SlopeRetainWallDistress: concatenate(_hd.ddlSlopeRetainWallDistress),
            SlopeRetainWallSeverity: _hd.ddlSlopeRetainWallSeverity.val(),
            SlopeRetainWallDistressOthers: _hd.txtSlopeRetainWallOthers.val(),

            Utilities: _hd.txtUtilities.val(),
            UtilitiesCode: _hd.txtUtilitiesCode.val(),
            UtilitiesDistress: concatenate(_hd.ddlUtilitiesDistress),
            UtilitiesSeverity: _hd.ddlUtilitiesSeverity.val(),
            UtilitiesDistressOthers: _hd.txtUtilitiesOthers.val(),

            WaterDownpipe: _hd.txtWaterDownpipe.val(),
            WaterDownpipeCode: _hd.txtWaterDownpipeCode.val(),
            WaterDownpipeDistress: concatenate(_hd.ddlWaterDownpipeDistress),
            WaterDownpipeSeverity: _hd.ddlWaterDownpipeSeverity.val(),
            WaterDownpipeDistressOthers: _hd.txtWaterDownpipeOthers.val(),

            WaterwayDistress: concatenate(_hd.ddlWaterwayDistress),
            WaterwaySeverity: _hd.ddlWaterwaySeverity.val(),
            Waterway: _hd.txtWaterway.val(),
            WaterwayCode: _hd.txtWaterwayCode.val(),
            WaterwayDistressOthers: _hd.txtWaterwayOthers.val()
        }
    }
}

var _img = {
    btnImAdd: $("#btnImAdd"),
    imgList: $("#imgList"),
    ImageView: $("#ImageView"),
    btnImModalClose: $("#btnImModalClose"),
    imageUploadModel: $("#imageUploadModel"),
    ddlPhototype: $("#ddlPhototype"),
    fileupload: $("#fileupload"),
    photolist: $("#photolist"),
    Filelist: $("#Filelist"),
    btnUpload: $("#btnUpload"),
    btnCancel: $("#btnCancel")
}


$(document).ready(function () {
    _hd.ddlBridgeId.chosen();
    _hd.ddlAuditedby.chosen();
    _hd.ddlAbutFoundMatDistress.chosen();
    _hd.ddlAbutFoundMatSeverity.chosen();
    _hd.ddlBeamsGridTrusArchDistress.chosen();
    _hd.ddlBeamsGridTrusArchSeverity.chosen();
    _hd.ddlBearingStDiaphgMatDistress.chosen();
    _hd.ddlBearingStDiaphgMatSeverity.chosen();
    _hd.ddlBrideConditionRating.chosen();
    _hd.ddlDeckPavementDistress.chosen();
    _hd.ddlDeckPavementSeverity.chosen();
    _hd.ddlExpanJointDistress.chosen();
    _hd.ddlExpanJointSeverity.chosen();
    _hd.ddlHasIssueFound.chosen();
    _hd.ddlInspectedby.chosen();
    _hd.ddlParapetRailingDistress.chosen();
    _hd.ddlParapetRailingSeverity.chosen();
    _hd.ddlPiersPrimCompMatDistress.chosen();
    _hd.ddlPiersPrimCompMatSeverity.chosen();
    _hd.ddlSidewalksAppSlabDistress.chosen();
    _hd.ddlSidewalksAppSlabSeverity.chosen();
    _hd.ddlSlopeRetainWallDistress.chosen();
    _hd.ddlSlopeRetainWallSeverity.chosen();
    _hd.ddlUtilitiesDistress.chosen();
    _hd.ddlUtilitiesSeverity.chosen();
    _hd.ddlWaterDownpipeDistress.chosen();
    _hd.ddlWaterDownpipeSeverity.chosen();
    _hd.ddlWaterwayDistress.chosen();
    _hd.ddlWaterwaySeverity.chosen();
    _hd.ddlYear.chosen();
    saveSubmitDisable();

    _hd.ddlYear.on("change", function () {
        var year = _hd.ddlYear.val();
        var dtOfInspYear = (new Date(_hd.txtDateofInspection.val())).getFullYear();
        if (year == "" || year == null || year == 0 || (year != dtOfInspYear)) {
            _hd.txtDateofInspection.val("");
        }
        _hd.txtDateofInspection.attr("min", (this.value + "-01-01"));
        _hd.txtDateofInspection.attr("max", (this.value + "-12-31"));

    });
    _hd.ddlYear.trigger("change");
    _hd.ddlBridgeId.on("change", function () {
        var req = {};
        req.id = this.value;
        //$.ajax({
        //    url: '/FormB1B2/GetBrideDetailById',
        //    dataType: 'JSON',
        //    data: req,
        //    type: 'Post',
        //    success: function (data) {
        //        assign(data);
        //    },
        //    error: function (data) {

        //        console.error(data);
        //    }
        //});

    });
    _hd.ddlInspectedby.on("change", function () {
        var value = this.value;
        var inspectedDate = new Date();
        if (value == "") {
            _hd.txtServiceProvidername.val('');
            _hd.txtServiceProviderDesignation.val('');
            _hd.txtServiceProvidername.prop("disabled", true);
            _hd.txtServiceProviderDesignation.prop("disabled", true);
        }
        else if (value == "99999999") {
            _hd.txtServiceProvidername.val('');
            _hd.txtServiceProviderDesignation.val('');
            _hd.txtServiceProvidername.prop("disabled", false);
            _hd.txtServiceProviderDesignation.prop("disabled", false);
        }
        else {
            getUserDetail(value, function (data) {
                _hd.txtServiceProvidername.val(data.userName);
                _hd.txtServiceProviderDesignation.val(data.position);
                _hd.txtServiceProvidername.prop("disabled", true);
                _hd.txtServiceProviderDesignation.prop("disabled", true);
                
                if (_hd.txtServiceProviderDate.val() == null || _hd.txtServiceProviderDate.val()=='') {
                    _hd.txtServiceProviderDate.val(inspectedDate.ToString(jsMaster.AssignFormat));
                }
                
            });
        }
    });
    _hd.ddlInspectedby.trigger('change');

    _hd.ddlAuditedby.on("change", function () {
        var value = this.value;
        if (value == "") {
            _hd.txtAuditedbyName.val('');
            _hd.txtAuditedbyDesignation.val('');
            _hd.txtAuditedbyName.prop("disabled", true);
            _hd.txtAuditedbyDesignation.prop("disabled", true);
        }
        else if (value == "99999999") {
            _hd.txtAuditedbyName.val('');
            _hd.txtAuditedbyDesignation.val('');
            _hd.txtAuditedbyName.prop("disabled", false);
            _hd.txtAuditedbyDesignation.prop("disabled", false);
        }
        else {
            getUserDetail(value, function (data) {
                _hd.txtAuditedbyName.val(data.userName);
                _hd.txtAuditedbyDesignation.val(data.position);
                _hd.txtAuditedbyName.prop("disabled", true);
                _hd.txtAuditedbyDesignation.prop("disabled", true);
            });
        }
    });

    if (_hd.hdnPkRefNo.val() != "0") {
        //B1RoadCodeChange();
        //B1SectionCodeChange();
        $(".fcontrol").prop("disabled", true);
        _hd.ddlBridgeId.trigger("chosen:updated");
        //_hd.ddlDivision.trigger("chosen:updated");
        //_hd.ddlSectionCode.trigger("chosen:updated");
        //_hd.ddlRmuCode.trigger("chosen:updated");
        //_hd.ddlRdCode.trigger("chosen:updated");
        _hd.ddlYear.trigger("chosen:updated");
        // $("[finddetailhide]").hide();
        _hd.btnFindDetail.hide();
        $("[finddetailhide]").hide();
    }

    if (_hd.ddlInspectedby.val() == "" || _hd.ddlInspectedby.val() != "99999999") {
        _hd.txtServiceProvidername.prop("disabled", true);
        _hd.txtServiceProviderDesignation.prop("disabled", true);
    }

    if (_hd.ddlAuditedby.val() == "" || _hd.ddlAuditedby.val() != "99999999") {
        _hd.txtAuditedbyName.prop("disabled", true);
        _hd.txtAuditedbyDesignation.prop("disabled", true);
    }

    if (_hd.hdnIsView.val() == "1") {
        $(".view").prop("disabled", true);
        $(".view").trigger("chosen:updated");
        _hd.btnHSave.hide();
        _hd.btnHSubmit.hide();
    }

    _hd.btnHSave.on("click", function () { save(false); });
    _hd.btnHSubmit.on("click", function () { save(true); });
    _hd.btnFindDetail.on("click", function () { findDetail(); });
    _hd.btnHCancel.on("click", function () {

        if (_hd.hdnIsView.val() == "1") {
            NavToList();
        }
        else if (app.Confirm("Unsaved changes will be lost. Are you sure you want to cancel?", function (e) {
            if (e) {
                NavToList();
            }
        }));

    });

    _hd.btnImgTab.on("click", function () {
        GetImageList();
    });
    if (_hd.hdnPkRefNo.val() == "0") {
        //B1RoadCodeChange();
        //B1SectionCodeChange();
    }

    _hd.ddlRmuCode.on("change", function () {
        bindBridgeIds();
        if (this.value == "") {
            bindSection();
            bindRoadCode();
            //_hd.txtHReferenceNo.val("");
            //_hd.txtRoadlength.val("");
            //_hd.ddlSection.val("");
            _hd.txtSectionName.val('');
            _hd.txtRoadName.val("");
        }
        else {
            //_hd.txtRmu.val(this.value);
            bindSection();
            bindRoadCode();
        }
    });

    _hd.ddlSectionCode.on("change", function () {
        bindRoadCode();
        if (this.value == "") {
            _hd.txtSectionName.val('');
        }
        else {
            _hd.txtSectionName.val(_hd.ddlSectionCode.find("option:selected").text().split("-")[1]);
        }
        bindBridgeIds();

    });

    _hd.ddlRdCode.on("change", function () {
        bindBridgeIds();
        if (this.value == "") {
            _hd.txtRoadName.val("");
        }
        else {
            _hd.txtRoadName.val(_hd.ddlRdCode.find("option:selected").attr('item1'));
            getRoadDetail();
        }
    });

    bindRMU();
    bindSection();
    bindRoadCode();

    if (_hd.hdnAbutFoundDistress.val() != '') {
        _hd.ddlAbutFoundMatDistress.val(_hd.hdnAbutFoundDistress.val().split(','));
        _hd.ddlAbutFoundMatDistress.trigger("chosen:updated");
    }

    if (_hd.hdnBeamsGridTrusArchDistress.val() != '') {
        _hd.ddlBeamsGridTrusArchDistress.val(_hd.hdnBeamsGridTrusArchDistress.val().split(','));
        _hd.ddlBeamsGridTrusArchDistress.trigger("chosen:updated");
    }

    if (_hd.hdnBearingStDiaphgDistress.val() != '') {
        var lst = _hd.hdnBearingStDiaphgDistress.val().split(',');
        _hd.ddlBearingStDiaphgMatDistress.val(lst);
        _hd.ddlBearingStDiaphgMatDistress.trigger("chosen:updated");
    }
    if (_hd.hdnDeckPavementDistress.val() != '') {
        _hd.ddlDeckPavementDistress.val(_hd.hdnDeckPavementDistress.val().split(','));
        _hd.ddlDeckPavementDistress.trigger("chosen:updated");
    }

    if (_hd.hdnExpanJointDistress.val() != '') {
        _hd.ddlExpanJointDistress.val(_hd.hdnExpanJointDistress.val().split(','));
        _hd.ddlExpanJointDistress.trigger("chosen:updated");
    }

    if (_hd.hdnParapetRailingDistress.val() != '') {
        _hd.ddlParapetRailingDistress.val(_hd.hdnParapetRailingDistress.val().split(','));
        _hd.ddlParapetRailingDistress.trigger("chosen:updated");
    }

    if (_hd.hdnPiersPrimCompDistress.val() != '') {
        _hd.ddlPiersPrimCompMatDistress.val(_hd.hdnPiersPrimCompDistress.val().split(','));
        _hd.ddlPiersPrimCompMatDistress.trigger("chosen:updated");
    }

    if (_hd.hdnSidewalksAppSlabDistress.val() != '') {
        _hd.ddlSidewalksAppSlabDistress.val(_hd.hdnSidewalksAppSlabDistress.val().split(','));
        _hd.ddlSidewalksAppSlabDistress.trigger("chosen:updated");
    }

    if (_hd.hdnSlopeRetainWallDistress.val() != '') {
        _hd.ddlSlopeRetainWallDistress.val(_hd.hdnSlopeRetainWallDistress.val().split(','));
        _hd.ddlSlopeRetainWallDistress.trigger("chosen:updated");
    }

    if (_hd.hdnUtilitiesDistress.val() != '') {
        _hd.ddlUtilitiesDistress.val(_hd.hdnUtilitiesDistress.val().split(','));
        _hd.ddlUtilitiesDistress.trigger("chosen:updated");
    }

    if (_hd.hdnWaterDownpipeDistress.val() != '') {
        _hd.ddlWaterDownpipeDistress.val(_hd.hdnWaterDownpipeDistress.val().split(','));
        _hd.ddlWaterDownpipeDistress.trigger("chosen:updated");
    }

    if (_hd.hdnWaterwayDistress.val() != '') {
        _hd.ddlWaterwayDistress.val(_hd.hdnWaterwayDistress.val().split(','));
        _hd.ddlWaterwayDistress.trigger("chosen:updated");
    }

});

function getRoadDetail() {
    var req = {};
    req.code = _hd.ddlRdCode.val();
    $.ajax({
        url: '/FormF2/GetRoadDetailByCode',
        dataType: 'JSON',
        data: req,
        type: 'Post',
        success: function (data) {
            _hd.ddlDivision.val(data.divisionCode);
            _hd.ddlDivision.trigger("chosen:updated");
            _hd.ddlRmuCode.val(data.rmuCode);
            _hd.ddlRmuCode.trigger("chosen:updated");
            //$("#ddlSectionCode option").filter(function () {
            //    debugger;
            //    return this.text.indexOf(data.secName) != -1;
            //}).attr('selected', true);
            _hd.ddlSectionCode.val(data.secCode);
            _hd.ddlSectionCode.trigger("chosen:updated");
            _hd.txtSectionName.val(data.secName);
        }
    });
}

function bindBridgeIds(callback) {
    var req = {};
    req.RMU = _hd.ddlRmuCode.val();
    req.SectionCode = _hd.ddlSectionCode.val();
    req.RdCode = _hd.ddlRdCode.val();


    $.ajax({
        url: '/FormB1B2/GetBridgeIds',
        dataType: 'JSON',
        data: req,
        type: 'Post',
        success: function (data) {

            //if (req.Section == "") {
            _hd.ddlBridgeId.empty();
            _hd.ddlBridgeId.append($("<option></option>").val("").html("Select BridgeId"));
            $.each(data, function (index, v) {
                _hd.ddlBridgeId.append($("<option></option>").val(v.value).html(v.text));
            });

            _hd.ddlBridgeId.trigger("chosen:updated");

            if (callback)
                callback();
        },
        error: function (data) {

            console.error(data);
        }
    });
}

function bindRMU(callback) {
    var req = {};
    req.RMU = ''
    req.Section = '';
    req.RdCode = '';
    _hd.txtSectionName.val('');
    _hd.txtRoadName.val("");
    $.ajax({
        url: '/FormB1B2/RMUSecRoad',
        dataType: 'JSON',
        data: req,
        type: 'Post',
        success: function (data) {

            _hd.ddlRmuCode.empty();
            _hd.ddlRmuCode.append($("<option></option>").val("").html("Select RMU"));
            $.each(data.rmu, function (index, v) {
                _hd.ddlRmuCode.append($("<option></option>").val(v.value).html((v.value + "-" + v.text)));
            });
            _hd.ddlRmuCode.trigger("chosen:updated");

            if (callback)
                callback();
        },
        error: function (data) {
            console.error(data);
        }
    });
}

function bindSection(callback) {

    var req = {};
    var _rmu = _hd.ddlRmuCode;
    var _sec = _hd.ddlSectionCode;
    var _road = _hd.ddlRdCode;
    req.RMU = _hd.ddlRmuCode.val();
    req.SectionCode = '';
    req.RdCode = '';
    _hd.txtRoadName.val("");
    _hd.txtSectionName.val("");
    $.ajax({
        url: '/FormB1B2/RMUSecRoad',
        dataType: 'JSON',
        data: req,
        type: 'Post',
        success: function (data) {

            _hd.ddlSectionCode.empty();
            _hd.ddlSectionCode.append($("<option></option>").val("").html("Select Section Code"));
            $.each(data.section, function (index, v) {
                _hd.ddlSectionCode.append($("<option></option>").val(v.value).html(v.text));
            });
            _hd.ddlSectionCode.trigger("chosen:updated");
            if (callback)
                callback();
        },
        error: function (data) {

            console.error(data);
        }
    });
}


function bindRoadCode(callback) {

    var req = {};
    var _rmu = _hd.ddlRmuCode
    var _sec = _hd.ddlSectionCode;
    var _road = _hd.ddlRdCode;
    req.RMU = _hd.ddlRmuCode.val();
    req.SectionCode = _hd.ddlSectionCode.val();
    req.RdCode = '';
    $("#txtRoadName").val("");
    $.ajax({
        url: '/FormB1B2/RMUSecRoad',
        dataType: 'JSON',
        data: req,
        type: 'Post',
        success: function (data) {
            _road.empty();
            _road.append($("<option></option>").val("").html("Select Road Code"));
            $.each(data.rdCode, function (index, v) {
                _road.append($("<option></option>").val(v.value).html(v.text).attr("Item1", v.item1).attr("Item3", v.item3).attr("PKId", v.pkId).attr("code", v.code));
            });
            _road.trigger("chosen:updated");
            if (callback)
                callback();
        },
        error: function (data) {

            console.error(data);
        }
    });
}

function findDetail() {
    var req = {};
    req.AiPkRefNo = _hd.ddlBridgeId.val();
    req.DtOfInsp = _hd.txtDateofInspection.val();
    req.RecordNo = _hd.ddlRatingRecordno.val();
    req.DisplayAssetId = _hd.ddlBridgeId.find("option:selected").text();
    req.YearOfInsp = _hd.ddlYear.val();
    if (ValidatePage(".fcontrol", "", "validate")) {
        $.ajax({
            url: '/FormB1B2/CheckExistence',
            dataType: 'JSON',
            data: req,
            type: 'Post',
            success: function (data) {
                if (data.id > 0) {
                    window.location.href = "/FormB1B2/Add?id=" + data.id + "&isview=0";
                }
                else {
                    app.ShowErrorMessage("Failed to save");
                }
                saveSubmitDisable()
            },
            error: function (data) {
                console.error(data);
            }
        });
    }
}

function save(issubmit = false) {
    var req = get();
    req.SubmitSts = issubmit;
    var isvalid = false;
    if (issubmit) {
        isvalid = ValidatePage(".submit", "", "validate");
    }
    else {
        isvalid = ValidatePage(".save", "", "validate");
    }
    if (isvalid) {
        $.ajax({
            url: '/FormB1B2/Save',
            dataType: 'JSON',
            data: req,
            type: 'Post',
            success: function (data) {
                if (data > 0) {
                    app.ShowSuccessMessage("Saved successfully", false);
                    setTimeout(function () {
                        NavToList();
                    }, 3000);
                }
                else if (data == -1) {
                    app.Alert("Atleast one photo is require for each photo type");
                }
                else {
                    app.ShowErrorMessage("Failed to save");
                }
            },
            error: function (data) {
                console.error(data);
            }
        });
    }
}
function NavToList() {
    window.location = _APPLocation + "FormB1B2";
}
function getUserDetail(id, callback) {
    var req = {};
    req.id = id;
    $.ajax({
        url: '/NOD/GetUserById',
        dataType: 'JSON',
        data: req,
        type: 'Post',
        success: function (data) {
            callback(data);
        },
        error: function (data) {
            console.error(data);
        }
    });
}
/** Image Upload */


function GetImageList() {
    var id = _hd.hdnPkRefNo.val();
    $.ajax({
        url: '/FormB1B2/GetImageList',
        data: { assetPk: id },
        type: 'POST',
        success: function (data) {
            $("#ViewPhoto").html(data);
            $("#formAFadPKRefNO").val(id);
        },
        error: function (data) {
            alert(data.responseText);
        }

    });
}

function saveSubmitDisable() {
    var no = $("#hdnPkRefNo").val();
    if (no > 0) {
        $("[B1B2SaveSubmitdep]").show();
    }
    else {
        $("[B1B2SaveSubmitdep]").hide();
    }
}

function B1RoadCodeChange() {
    var ctrl = $("#ddlRdCode");
    if (ctrl.val() != null) {
        $("[B1RoadName]").val(ctrl.find("option:selected").text().split("-")[1]);
    }
    else
        $("[B1RoadName]").val('');
}

function DistressChange(tis, div) {
    var ctrl = $(tis);
    var item1 = ctrl.find(":selected").val();
    if (item1 == "B22") {
        $("[" + div + "]").removeAttr("hidden");
        $("[" + div + "]").find("[DistressOthers]").val("").addClass("validate");
    }
    else {
        $("[" + div + "]").attr("hidden", true)
        $("[" + div + "]").find("[DistressOthers]").val("").removeClass("validate");
    }
}
